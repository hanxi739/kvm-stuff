# GP-linux+RT-KVM 项目问题汇总
  课题需求综合了现有acrn以及PRT-linux+RT-KVM两种方案的缺点，预期目标基于GP-linux结合RT-KVM开发支持低时延的RT-VM。我们认为基本思路有两种：一是采用对VM的硬件资源的硬划分与隔离，将VM中的大部分资源绑定，在VM中运行RTOS，来支持完成时间确定性的任务。二是可以将VM中的实时任务暴露给hypervisor，可以通过在hypervisor级别实现多级调度算法，来确保任务的确定性时延，同时最大化吞吐率。
## 方案一
虽然RTOS可以支持确定性任务，但是运行与VM中后，会受到hypervisor的管理，进而从硬件和软件层面对其性能有所影响。
### 硬件层面：
1. 虚拟化涉及的几个大方面：处理器虚拟化，内存虚拟化，I/O虚拟化，中断虚拟化，其硬件资源可分为可共享和独占式硬件，对于独占式硬件（硬件本身不支持虚拟化）硬划分是否可行，如何进行划分?（举例说明）
2. 为了确保确定完成时间，硬件相关中断的处理：I/O中断，时钟中断，IPI等。如何确保不产生副作用？
3. 硬件资源的静态分区后，通过pass-through的方式减少模式切换，是否会造成host本身无法使用该资源，同时hypervisor本身的资源管理应该到什么级别？
### 软件层面：
1.  hypervisor本身对资源进行管理，处理vm对资源的请求，hypervisor在响应vm的请求时，涉及到大量的模式切换，在增强分区减少vmexit的情况下，是否也应该提出一种exitless的方式来完成vm的请求？
2.  在静态分区的作用下，带来的副作用是资源利用率会下降，是否寻求更好的运行时动态自适应的划分方法？
3.  给vm预留资源，会导致Host本身资源减少，吞吐量下降，host本身的性能是否需要考虑？
4. openstack目前实现的rt-kvm在使用中具体存在什么样的问题？

## 方案二
  不做资源的静态划分，仍然统一通过hypervisor提供访问，RTOS本身的进程过线程实际运行的VCPU，将相关信息报告给hypervisor，有hypervisor感知当前运行的所有rt/nrt线程，统一进行资源分配和vcpu调度（intra-aware hypervisor）。同时结合目前已实现的优化技术，支持实时任务，保证整体吞吐率。